<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Treatment Effects with Multiple Periods and Groups • did</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Treatment Effects with Multiple Periods and Groups">
<meta property="og:description" content="The standard Difference-in-Differences (DID) setup involves two periods and two groups -- a treated group and untreated group.  Many applications of DID methods involve more than two periods and have individuals that are treated at different points in time.  This package contains tools for computing average treatment effect parameters in Difference in Differences models with more than two periods and with variation in treatment timing using the methods developed in Callaway and Sant'Anna (2018) &lt;https://ssrn.com/abstract=3148250&gt;.  The main parameters are group-time average treatment effects which are the average treatment effect for a particular group at a a particular time.  These can be aggregated into a fewer number of treatment effect parameters, and the package deals with the cases where there is selective treatment timing, dynamic treatment effects, calendar time effects, or combinations of these.  There are also functions for testing the Difference in Differences assumption, and plotting group-time average treatment effects.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">did</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/did-basics.html">DID Basics</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="did" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#did" class="anchor"></a>did</h1></div>
<p>The  package contains tools for computing average treatment effect parameters in Difference in Differences models with more than two periods, with variation in treatment timing across individuals, and where the DID assumption possibly holds conditional on covariates. The main parameters are group-time average treatment effects which are the average treatment effect for a particular group at a a particular time. These can be aggregated into a fewer number of treatment effect parameters, and the package deals with the cases where there is selective treatment timing, dynamic treatment effects, calendar time effects, or combinations of these. There are also functions for testing the Difference in Differences assumption, and plotting group-time average treatment effects.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install  from CRAN with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"did"</span>)</code></pre></div>
<p>or get the latest version from github with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools::<span class="kw">install_github</span>(<span class="st">"bcallaway11/did"</span>)</code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>The following is a simplified example of the effect of states increasing their minimum wages on county-level teen employment rates which comes from Callaway and Sant’Anna (2018).</p>
<p>A subset of the data is available in the package and can be loaded by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(did)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(mpdta)</code></pre></div>
The dataset contains 500 observations of county-level teen employment rates from 2003-2007. Some states are first treated in 2004, some in 2006, and some in 2007 (see the paper for details). We are interested in estimating the group-time average treatment effect, which is the average treatment effect in period <span class="math inline">\(t\)</span> for the group of states first treated in period <span class="math inline">\(g\)</span> and given by
\begin{align*}
ATT(g,t)=E[Y_t(1) - Y_t(0)|G_g=1]
\end{align*}
under the common trends assumption:
\begin{align*}
  E[\Delta Y_t(0) | X, G_g=1] = E[\Delta Y_t(0) | X, C=1] \ a.s. \quad \forall g\leq t
\end{align*}
<p>where <span class="math inline">\(Y_t(1)\)</span> and <span class="math inline">\(Y_t(0)\)</span> denote treated and untreated potential outcomes, <span class="math inline">\(G_g=1\)</span> denotes counties first treated in period <span class="math inline">\(g\)</span>, <span class="math inline">\(C=1\)</span> denotes control counties that are never treated.</p>
<p>To estimate <span class="math inline">\(ATT(g,t)\)</span>, one can use the  method as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw"><a href="reference/mp.spatt.html">mp.spatt</a></span>(lemp ~<span class="st"> </span>treat, <span class="dt">xformla=</span>~lpop, <span class="dt">data=</span>mpdta,
                 <span class="dt">panel=</span><span class="ot">TRUE</span>, <span class="dt">first.treat.name=</span><span class="st">"first.treat"</span>,
                 <span class="dt">idname=</span><span class="st">"countyreal"</span>, <span class="dt">tname=</span><span class="st">"year"</span>,
                 <span class="dt">bstrap=</span><span class="ot">FALSE</span>, <span class="dt">se=</span><span class="ot">TRUE</span>, <span class="dt">cband=</span><span class="ot">FALSE</span>)
<span class="co">#&gt; current period: 2004 </span>
<span class="co">#&gt; current group: 2004 </span>
<span class="co">#&gt; set pretreatment period to be 2003 </span>
<span class="co">#&gt; current period: 2005 </span>
<span class="co">#&gt; current group: 2004 </span>
<span class="co">#&gt; set pretreatment period to be 2003 </span>
<span class="co">#&gt; current period: 2006 </span>
<span class="co">#&gt; current group: 2004 </span>
<span class="co">#&gt; set pretreatment period to be 2003 </span>
<span class="co">#&gt; current period: 2007 </span>
<span class="co">#&gt; current group: 2004 </span>
<span class="co">#&gt; set pretreatment period to be 2003 </span>
<span class="co">#&gt; current period: 2006 </span>
<span class="co">#&gt; current group: 2006 </span>
<span class="co">#&gt; set pretreatment period to be 2005 </span>
<span class="co">#&gt; current period: 2007 </span>
<span class="co">#&gt; current group: 2006 </span>
<span class="co">#&gt; set pretreatment period to be 2005 </span>
<span class="co">#&gt; current period: 2007 </span>
<span class="co">#&gt; current group: 2007 </span>
<span class="co">#&gt; set pretreatment period to be 2006</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(out)
<span class="co">#&gt; </span>
<span class="co">#&gt; Reference: Callaway, Brantly and Sant'Anna, Pedro.  "Difference-in-Differences with Multiple Time Periods." Working Paper &lt;https://ssrn.com/abstract=3148250&gt;, 2019. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  group   time          att          se</span>
<span class="co">#&gt; ------  -----  -----------  ----------</span>
<span class="co">#&gt;   2004   2004   -0.0145484   0.0219886</span>
<span class="co">#&gt;   2004   2005   -0.0764499   0.0284761</span>
<span class="co">#&gt;   2004   2006   -0.1404646   0.0350339</span>
<span class="co">#&gt;   2004   2007   -0.1069326   0.0330405</span>
<span class="co">#&gt;   2006   2004   -0.0008686   0.0221298</span>
<span class="co">#&gt;   2006   2005   -0.0063972   0.0185132</span>
<span class="co">#&gt;   2006   2006    0.0012080   0.0192254</span>
<span class="co">#&gt;   2006   2007   -0.0413082   0.0196941</span>
<span class="co">#&gt;   2007   2004    0.0265561   0.0141314</span>
<span class="co">#&gt;   2007   2005   -0.0046609   0.0155829</span>
<span class="co">#&gt;   2007   2006   -0.0283403   0.0181435</span>
<span class="co">#&gt;   2007   2007   -0.0288948   0.0162974</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; P-value for pre-test of DID assumption:  0.23803</span></code></pre></div>
<p>and plot the results using the  command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gridExtra)
<span class="kw"><a href="reference/ggdid.html">ggdid</a></span>(out)</code></pre></div>
<div class="figure">
<img src="reference/figures/README-unnamed-chunk-6-1.png">
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=did">https://​cloud.r-project.org/​package=did</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Brantly Callaway <br><small class="roles"> Author, maintainer </small>  </li>
<li>Pedro H.C. Sant'Anna <br><small class="roles"> Author </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Brantly Callaway, Pedro H.C. Sant'Anna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
